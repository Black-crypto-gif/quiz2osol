import { useState } from "react";

const questions = [
  {
    question: "ما الحكمة من بدء المؤلف كتابه بالبسملة؟",
    options: [
      "اقتداء بكتاب الله",
      "اتباعًا لحديث النبي صلى الله عليه وسلم",
      "الاقتداء بالرسول صلى الله عليه وسلم",
      "جميع ما سبق",
    ],
    answer: "جميع ما سبق",
  },
  {
    question: "ما تقدير الجار والمجرور في 'بسم الله'؟",
    options: [
      "بسم الله أبدأ",
      "بسم الله أكتب",
      "بسم الله أصنف",
      "بسم الله أقرأ",
    ],
    answer: "بسم الله أكتب",
  },
  {
    question: "ما الفرق بين اسمي 'الرحمن' و'الرحيم'؟",
    options: [
      "الرحمن يختص بالله فقط، والرحيم يطلق على الله وغيره",
      "الرحمن يطلق على الله وغيره، والرحيم يختص بالله فقط",
      "لا فرق بينهما",
      "كلاهما يطلق على الله فقط",
    ],
    answer: "الرحمن يختص بالله فقط، والرحيم يطلق على الله وغيره",
  },
  {
    question: "ما هي مراتب الإدراك الست؟",
    options: [
      "العلم، الجهل البسيط، الجهل المركب، الوهم، الشك، الظن",
      "العلم، الجهل، الوهم، الشك، الظن، اليقين",
      "العلم، الجهل البسيط، الجهل المركب، الوهم، الشك، اليقين",
      "العلم، الجهل، الوهم، الشك، الظن، اليقين",
    ],
    answer: "العلم، الجهل البسيط، الجهل المركب، الوهم، الشك، الظن",
  },
  {
    question: "ما الفرق بين العلم الضروري والعلم النظري؟",
    options: [
      "العلم الضروري يحتاج إلى استدلال، والعلم النظري لا يحتاج",
      "العلم الضروري لا يحتاج إلى استدلال، والعلم النظري يحتاج",
      "لا فرق بينهما",
      "العلم الضروري يتعلق بالدين، والعلم النظري يتعلق بالدنيا",
    ],
    answer: "العلم الضروري لا يحتاج إلى استدلال، والعلم النظري يحتاج",
  },
  {
    question: "ما هي المسائل الأربع التي يجب تعلمها؟",
    options: [
      "معرفة الله، معرفة النبي، معرفة الدين الإسلامي، معرفة الأحكام الشرعية",
      "معرفة الله، معرفة الملائكة، معرفة الكتب، معرفة اليوم الآخر",
      "معرفة الله، معرفة النبي، معرفة الدين الإسلامي، معرفة الآيات الكونية",
      "معرفة الله، معرفة النبي، معرفة الدين الإسلامي، معرفة الشريعة",
    ],
    answer: "معرفة الله، معرفة النبي، معرفة الدين الإسلامي، معرفة الشريعة",
  },
  {
    question: "ما معنى 'الله' في قوله تعالى: {اللَّهُ الَّذِي لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ}؟",
    options: [
      "لفظ الجلالة صفة لله",
      "لفظ الجلالة عطف بيان",
      "لفظ الجلالة تابع تبعية النعت للمنعوت",
      "لفظ الجلالة اسم علم فقط",
    ],
    answer: "لفظ الجلالة عطف بيان",
  },
  {
    question: "ما معنى 'الرحمن'؟",
    options: [
      "ذو الرحمة الواسعة",
      "ذو الرحمة الواصلة",
      "المتسامح",
      "المغفور له",
    ],
    answer: "ذو الرحمة الواسعة",
  },
  {
    question: "ما معنى 'الرحيم'؟",
    options: [
      "ذو الرحمة الواسعة",
      "ذو الرحمة الواصلة",
      "المتسامح",
      "المغفور له",
    ],
    answer: "ذو الرحمة الواصلة",
  },
  {
    question: "ما هي الآية التي تدل على أن الله يعذب من يشاء ويرحم من يشاء؟",
    options: [
      "{يُعَذِّبُ مَنْ يَشَاءُ وَيَرْحَمُ مَنْ يَشَاءُ وَإِلَيْهِ تُقْلَبُونَ}",
      "{وَاعْبُدُوا اللَّهَ وَلا تُشْرِكُوا بِهِ شَيْئاً}",
      "{قُلْ هُوَ اللَّهُ أَحَدٌ}",
      "{الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ}",
    ],
    answer: "{يُعَذِّبُ مَنْ يَشَاءُ وَيَرْحَمُ مَنْ يَشَاءُ وَإِلَيْهِ تُقْلَبُونَ}",
  },
  {
    question: "ما هي الآية التي تدل على وجود آيات في الأرض للعالمين؟",
    options: [
      "{وَفِي الْأَرْضِ آيَاتٌ لِلْمُوقِنِينَ وَفِي أَنْفُسِكُمْ أَفَلا تُبْصِرُونَ}",
      "{وَاعْبُدُوا اللَّهَ وَلا تُشْرِكُوا بِهِ شَيْئاً}",
      "{قُلْ هُوَ اللَّهُ أَحَدٌ}",
      "{الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ}",
    ],
    answer: "{وَفِي الْأَرْضِ آيَاتٌ لِلْمُوقِنِينَ وَفِي أَنْفُسِكُمْ أَفَلا تُبْصِرُونَ}",
  },
  {
    question: "ما هي الآية التي تدل على وجوب تحكيم الرسول صلى الله عليه وسلم؟",
    options: [
      "{فَلا وَرَبِّكَ لا يُؤْمِنُونَ حَتَّى يُحَكِّمُوكَ فِيمَا شَجَرَ بَيْنَهُمْ}",
      "{وَاعْبُدُوا اللَّهَ وَلا تُشْرِكُوا بِهِ شَيْئاً}",
      "{قُلْ هُوَ اللَّهُ أَحَدٌ}",
      "{الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ}",
    ],
    answer: "{فَلا وَرَبِّكَ لا يُؤْمِنُونَ حَتَّى يُحَكِّمُوكَ فِيمَا شَجَرَ بَيْنَهُمْ}",
  },
  {
    question: "ما هي الآية التي تدل على أن الإسلام هو دين الله منذ إرسال الرسل؟",
    options: [
      "{رَبَّنَا وَاجْعَلْنَا مُسْلِمَيْنِ لَكَ وَمِنْ ذُرِّيَّتِنَا أُمَّةً مُسْلِمَةً}",
      "{وَاعْبُدُوا اللَّهَ وَلا تُشْرِكُوا بِهِ شَيْئاً}",
      "{قُلْ هُوَ اللَّهُ أَحَدٌ}",
      "{الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ}",
    ],
    answer: "{رَبَّنَا وَاجْعَلْنَا مُسْلِمَيْنِ لَكَ وَمِنْ ذُرِّيَّتِنَا أُمَّةً مُسْلِمَةً}",
  },
];

function Quiz({ setScore, setQuizStarted, saveScore }) {
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [selectedOption, setSelectedOption] = useState("");
  const [correctAnswers, setCorrectAnswers] = useState(0);

  const handleNext = () => {
    if (selectedOption === questions[currentQuestion].answer) {
      setCorrectAnswers((prev) => prev + 1); // Increment correct answers
    }
    setSelectedOption("");
    if (currentQuestion < questions.length - 1) {
      setCurrentQuestion((prev) => prev + 1);
    } else {
      const percentage = (correctAnswers / questions.length) * 100; // Calculate percentage
      setScore(percentage); // Update score in parent component
      saveScore(percentage); // Save percentage to Firestore
      setQuizStarted(false); // End the quiz
    }
  };

  return (
    <div className="quiz">
      <h2>{questions[currentQuestion].question}</h2>
      {questions[currentQuestion].options.map((option, index) => (
        <div key={index}>
          <label>
            <input
              type="radio"
              name="option"
              value={option}
              checked={selectedOption === option}
              onChange={() => setSelectedOption(option)}
            />
            {option}
          </label>
        </div>
      ))}
      <button onClick={handleNext}>التالي</button>
    </div>
  );
}

export default Quiz;